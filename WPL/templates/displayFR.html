{% extends "base.html" %} {% block head %} {{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename= 'extended_beauty.css') }}"/>
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/bottom-nav.css') }}">
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='fixtures.css') }}">
<style>
:root {
   --border_orange :#ffb09e;
   --border_orange_light :#ffe4dd;
}
.plain-link {
  text-decoration: none !important; /* Removes underline */
  color: inherit;        /* Keeps color same as surrounding text */
  cursor: pointer;       /* Normal text cursor */
}
.border {
  border:0px solid #ffe4dd!important;
}
.border_orange {
  border:0px solid #ffb09e!important;
}

</style>
{% endblock %}

{% block content %}
<div style="background-image: url('/static/images/banner_bg.jpg'); padding-top: 79px; background-size: cover;
            background-attachment: fixed;">
<center>
<div>
  {% macro num_suffix(n) %}
    {% if n % 100 in [11, 12, 13] %}
        {{ n }}th
    {% elif n % 10 == 1 %}
        {{ n }}st
    {% elif n % 10 == 2 %}
        {{ n }}nd
    {% elif n % 10 == 3 %}
        {{ n }}rd
    {% else %}
        {{ n }}th
    {% endif %}
{% endmacro %}

    {% set teams = ['DCW', 'GG', 'MIW', 'RCBW', 'UPW'] %}
    <a href="{{ url_for('main.displayFR', fteam='All') }}" 
     class="custom-button {{ 'active' if hint == 'All' else '' }}">
     All
  </a>

  {% for i in teams %}
    <a href="{{ url_for('main.displayFR', fteam=i) }}" 
       class="custom-button {{ 'active' if hint == i else '' }}">
       {{ i }}
    </a>
  {% endfor %}
</div>
<div style="padding-bottom: 35px;"></div>
{% for i in FR[1:] %}
{% if i[1] > current_date %}
<a href="{{ url_for('main.FRScore', match=i[0], source='displayFR', fteam=hint) }}" class="plain-link">
<div class="main-container">
  <div class="score-card border">
    <div class="header" style="{% if i[0] | int(default=None) is not none %} --c: #25478A; {% else %} --c: #401F52; {% endif %}" data-deadline="{{ i[1].strftime('%Y-%m-%dT%H:%M:%S') }}">
    <div style="display: block;">
      <div class="date">{% if i[0] | int(default=None) is not none %}{{ "MATCH" ~ " " ~ i[0]  }}{% else %}{{ i[0] | upper }}{% endif %}</div>{{ i[1].strftime('%A, %d %B %Y') }}
    </div>
  </div>
    <div class="match-info">{{ i[2] }}</div>
    <div class="score-container">
      <div class="team-new left-team">
        <div class="team-display" full="{{ fn[i[3]] }}" short="{{ i[3] }}">
          {{ fn[i[3]] }}
        </div>
        <div class="team-logo">
          <img src="/static/images/squad_logos/{{ i[3] }}.webp" alt="India Flag">
        </div>
      </div>

      {% if i[0] | int(default=None) is not none %}
      <div class="vs-circle">VS</div>
      {% elif i[0] == 'Eliminator' %}
      <div class="eliminator"><img src="/static/images/eliminator.png"></div>
      {% else %}
      <div class="final"><img src="/static/images/final.png"></div>
      {% endif %}

      <div class="team-new right-team">
        <div class="team-logo">
          <img src="/static/images/squad_logos/{{ i[4] }}.webp" alt="India Flag">
        </div>
        <div class="team-display" full="{{ fn[i[4]] }}" short="{{ i[4] }}">
          {{ fn[i[4]] }}
        </div>
      </div>
    </div>
      <!-- Result -->
      <div class="result" style="color: #dc6604">Starts {{ i[1].strftime('%a, %d %b') }} &bull; {{ i[1].strftime('%I:%M %p') }} IST</div>
  </div>

  <div class="timer-card border">
    <div class="header" style="{% if i[0] | int(default=None) is not none %} --c: #25478A; {% else %} --c: #401F52; {% endif %}">Match starts in</div>

      <div class="clockdiv" data-deadline="{{ i[1].strftime('%Y-%m-%dT%H:%M:%S') }}" style="padding-top: 20px">
    <div>
        <span class="days" id="day"></span>
        <div class="smalltext">DAYS</div>
    </div>
    <div>
        <span class="hours" id="hour"></span>
        <div class="smalltext">HRS</div>
    </div>
    <div>
        <span class="minutes" id="minute"></span>
        <div class="smalltext">MINS</div>
    </div>
    <div>
        <span class="seconds" id="second"></span>
        <div class="smalltext">SECS</div>
    </div>
</div>
  </div>
</div></a>

{% elif i[1] <= current_date and i[7] == 'TBA' %}
    <a href="{{ url_for('main.FRScore', match=i[0], source='displayFR', fteam=hint) }}" class="plain-link">
<div class="main-container">
  <div class="score-card border">
    <div class="header" style="{% if i[0] | int(default=None) is not none %} --c: #25478A; {% else %} --c: #401F52; {% endif %}" data-deadline="{{ i[1].strftime('%Y-%m-%dT%H:%M:%S') }}">
    <div style="display: block;">
      <div class="date">{% if i[0] | int(default=None) is not none %}{{ "MATCH" ~ " " ~ i[0]  }}{% else %}{{ i[0] | upper }}{% endif %}</div>{{ i[1].strftime('%A, %d %B %Y') }}
    </div>
  </div>
    <div class="match-info">{{ i[2] }}</div>
     <div class="score-container">
      <div class="team-new left-team">
        <div class="team-display" full="{{ fn[i[3]] }}" short="{{ i[3] }}">
          {{ fn[i[3]] }}
        </div>
        <div class="team-logo">
          <img src="/static/images/squad_logos/{{ i[3] }}.webp" alt="India Flag">
        </div>
      </div>

      {% if i[0] | int(default=None) is not none %}
      <div class="vs-circle">VS</div>
      {% elif i[0] == 'Eliminator' %}
      <div class="eliminator"><img src="/static/images/eliminator.png"></div>
      {% else %}
      <div class="final"><img src="/static/images/final.png"></div>
      {% endif %}

      <div class="team-new right-team">
        <div class="team-logo">
          <img src="/static/images/squad_logos/{{ i[4] }}.webp" alt="India Flag">
        </div>
        <div class="team-display" full="{{ fn[i[4]] }}" short="{{ i[4] }}">
          {{ fn[i[4]] }}
        </div>
      </div>
    </div>
      <!-- Result -->
      <div class="result" style="color: #c11616"><span class="result-span blink">Match is In-Progress</span></div>
  </div>
  <div class="timer-card">
    <div class="header" style="{% if i[0] | int(default=None) is not none %} --c: #25478A; {% else %} --c: #401F52; {% endif %}">Match is In-Progress</div>
      <div class="vsblock" style="padding-top: 35px;">
		<img class="team-image" style="{% if i[3] == 'RCBW' %} --c1: {{ clr[i[3]]['c3'] }}; --c2: {{ clr[i[3]]['c1'] }}; {% elif i[3] == 'GG' %} --c1: {{ clr[i[3]]['c1'] }}; --c2: {{ clr[i[3]]['c3'] }}; {% else %} --c1: {{ clr[i[3]]['c1'] }}; --c2: {{ clr[i[3]]['c2'] }};{% endif %}" src="\static\images\squad_logos\{{ i[3] }}.webp" alt="Team Logo" />
		<img class="vs-image" src="\static\images\vs.png" alt="Team Logo" />
		<img class="team-image" style="{% if i[4] == 'RCBW' %} --c1: {{ clr[i[4]]['c3'] }}; --c2: {{ clr[i[4]]['c1'] }}; {% elif i[4] == 'GG' %} --c1: {{ clr[i[4]]['c1'] }}; --c2: {{ clr[i[4]]['c3'] }}; {% else %} --c1: {{ clr[i[4]]['c1'] }}; --c2: {{ clr[i[4]]['c2'] }};{% endif %}" src="\static\images\squad_logos\{{ i[4] }}.webp" alt="Team Logo" />
</div>
  </div>
</div></a>

{% elif i[7] != 'TBA' %}
    <a href="{{ url_for('main.FRScore', match=i[0], source='displayFR', fteam=hint) }}" class="plain-link">
<div class="main-container">
  <div class="score-card border">
    <div class="header" style="{% if i[0] | int(default=None) is not none %} --c: #25478A; {% else %} --c: #401F52; {% endif %}" data-deadline="{{ i[1].strftime('%Y-%m-%dT%H:%M:%S') }}">
    <div style="display: block;">
      <div class="date">{% if i[0] | int(default=None) is not none %}{{ "MATCH" ~ " " ~ i[0]  }}{% else %}{{ i[0] | upper }}{% endif %}</div>{{ i[1].strftime('%A, %d %B %Y') }}
  </div>
  </div>
    <div class="match-info">{{ i[2] }}</div>
    {% if 'Super over' not in i[10] %}
      {% if i[7] == i[3] and i[8] == "runs" %}
      {% set TA, TB, TA_S, TB_S = i[3], i[4], i[5], i[6] %}
      {% elif i[7] == i[3] and i[8] == "wickets" %}
      {% set TA, TB, TA_S, TB_S = i[4], i[3], i[6], i[5] %}
      {% elif i[7] == i[4] and i[8] == "runs" %}
      {% set TA, TB, TA_S, TB_S = i[4], i[3], i[6], i[5] %}
      {% else %}
      {% set TA, TB, TA_S, TB_S = i[3], i[4], i[5], i[6] %}
      {% endif %}
    {% else %}
      {% if i[7] == i[3] and i[8] == "runs" %}
      {% set TA, TB, TA_S, TB_S = i[4], i[3], i[6], i[5] %}
      {% elif i[7] == i[3] and i[8] == "wickets" %}
      {% set TA, TB, TA_S, TB_S = i[3], i[4], i[5], i[6] %}
      {% elif i[7] == i[4] and i[8] == "runs" %}
      {% set TA, TB, TA_S, TB_S = i[3], i[4], i[5], i[6] %}
      {% else %}
      {% set TA, TB, TA_S, TB_S = i[4], i[3], i[6], i[5] %}
      {% endif %}
    {% endif %}

    <div class="score-container">
      <div class="team-new left-team">
        {% if "Super over" not in i[10] %}
          {% if TA_S['overs'] == 0 and TA_S['runs'] == 0 and TA_S['wkts'] == 0 %}
            <div class="team-display" full="{{ fn[i[3]] }}" short="{{ i[3] }}">
            {{ fn[i[3]] }}
            </div>
          {% else %}
            <div class="score-board">
              <div class="score-new {% if TA == i[7] and i[0] | int(default=None) is none %}playoff-win{% elif TA == i[7] %}score-win{% endif %}">{{ TA_S['runs'] }}{{ "" if TA_S['wkts'] == 10 else '/' ~ TA_S['wkts'] }}</div>
              <div class="overs {% if TA == i[7] %}overs-win{% endif %}">({{ TA_S['overs'] }})</div>
            </div>
          {% endif %}
        {% else %}
        <div class="score-board">
          <div class="score-new">{{ TA_S['runs'] }}{{ "" if TA_S['wkts'] == 10 else '/' ~ TA_S['wkts'] }}&nbsp;<span class="overs overs-so-font">({{ TA_S['overs'] }})</span></div>
          <div class="score-new {% if TA == i[7] and i[0] | int(default=None) is none %}playoff-win{% elif TA == i[7] %}score-win{% endif %}">{{ TA_S['runsSO'] }}{{ "" if TA_S['wktsSO'] == 10 else '/' ~ TA_S['wktsSO'] }}&nbsp;<span class="overs overs-so-font {% if TA == i[7] %}overs-win{% endif %}">({{ TA_S['oversSO'] }})</span></div>
        </div>
        {% endif %}
        <div class="team-logo">
          <img src="/static/images/squad_logos/{{ TA }}.webp" alt="India Flag">
        </div>
      </div>

      {% if i[0] | int(default=None) is not none %}
      <div class="vs-circle">VS</div>
      {% elif i[0] == 'Eliminator' %}
      <div class="eliminator"><img src="/static/images/eliminator.png"></div>
      {% else %}
      <div class="final"><img src="/static/images/final.png"></div>
      {% endif %}

      <div class="team-new right-team">
        <div class="team-logo">
          <img src="/static/images/squad_logos/{{ TB }}.webp" alt="India Flag">
        </div>
        {% if "Super over" not in i[10] %}
          {% if TB_S['overs'] == 0 and TB_S['runs'] == 0 and TB_S['wkts'] == 0 %}
          <div class="team-display" full="{{ fn[i[4]] }}" short="{{ i[4] }}">
            {{ fn[i[4]] }}
          </div>
          {% else %}
          <div class="score-board">
            <div class="score-new {% if TB == i[7] and i[0] | int(default=None) is none %}playoff-win{% elif TB == i[7] %}score-win{% endif %}">{{ TB_S['runs'] }}{{ "" if TB_S['wkts'] == 10 else '/' ~ TB_S['wkts'] }}</div>
            <div class="overs {% if TB == i[7] %}overs-win{% endif %}">({{ TB_S['overs'] }})</div>
          </div>
          {% endif %}
        {% else %}
        <div class="score-board">
          <div class="score-new">{{ TB_S['runs'] }}{{ "" if TB_S['wkts'] == 10 else '/' ~ TB_S['wkts'] }}&nbsp;<span class="overs overs-so-font">({{ TB_S['overs'] }})</span></div>
          <div class="score-new {% if TB == i[7] and i[0] | int(default=None) is none %}playoff-win{% elif TB == i[7] %}score-win{% endif %}">{{ TB_S['runsSO'] }}{{ "" if TB_S['wktsSO'] == 10 else '/' ~ TB_S['wktsSO'] }}&nbsp;<span class="overs overs-so-font {% if TB == i[7] %}overs-win{% endif %}">({{ TB_S['oversSO'] }})</span></div>
        </div>
        {% endif %}
      </div>
    </div>
      <!-- Result -->
      {% if i[7] == "NA" %}
      <div class="result">{{ i[10] }}</div>
      {% else %}
      <div class="result"><span class="team-name" full="{{ fn[i[7]] }}" short="{{ i[7] }}">{{ fn[i[7]] }}</span> {{ i[10] }}</div>
      {% endif %}
      </div>
  <div class="timer-card">
    {% if i[7] == "NA" or i[11][0] == "NA" %}
    <div class="header" style="{% if i[0] | int(default=None) is not none %} --c: #25478A; {% else %} --c: #401F52; {% endif %}">Match Abandoned</div>
    <div class="vsblock" style="padding-top: 35px;">
		  <img class="team-image" style="{% if i[3] == 'RCBW' %} --c1: {{ clr[i[3]]['c3'] }}; --c2: {{ clr[i[3]]['c1'] }}; {% elif i[3] == 'GG' %} --c1: {{ clr[i[3]]['c1'] }}; --c2: {{ clr[i[3]]['c3'] }}; {% else %} --c1: {{ clr[i[3]]['c1'] }}; --c2: {{ clr[i[3]]['c2'] }};{% endif %}" src="\static\images\squad_logos\{{ i[3] }}.webp" alt="Team Logo" />
		  <img class="vs-image" src="\static\images\vs.png" alt="Team Logo" />
		  <img class="team-image" style="{% if i[4] == 'RCBW' %} --c1: {{ clr[i[4]]['c3'] }}; --c2: {{ clr[i[4]]['c1'] }}; {% elif i[4] == 'GG' %} --c1: {{ clr[i[4]]['c1'] }}; --c2: {{ clr[i[4]]['c3'] }}; {% else %} --c1: {{ clr[i[4]]['c1'] }}; --c2: {{ clr[i[4]]['c2'] }};{% endif %}" src="\static\images\squad_logos\{{ i[4] }}.webp" alt="Team Logo" />
    </div>
    {% else %}
    <div class="header" style="{% if i[0] | int(default=None) is not none %} --c: #25478A; {% else %} --c: #401F52; {% endif %}">Player of the match</div>
    <div class="potm-content">
                <div class="potm-image text-blue" style="{% if i[11][1] == 'RCBW' %} --c1: {{ clr[i[11][1]]['c3'] }}; --c2: {{ clr[i[11][1]]['c1'] }}; {% elif i[11][1] == 'GG' %} --c1: {{ clr[i[11][1]]['c1'] }}; --c2: {{ clr[i[11][1]]['c3'] }}; {% else %} --c1: {{ clr[i[11][1]]['c1'] }}; --c2: {{ clr[i[11][1]]['c2'] }};{% endif %}">
                    <img src="/static/images/squads/{{ i[11][1] }}/{{ i[11][0].replace(' ', '-') }}.png" alt="{{ i[11][0] }}">
                </div>
                <div class="potm-details">
                    <div class="potm-name">{{ i[11][0] }}</div>
                    <div class="potm-team fw-bold">
                        <img src="/static/images/squad_logos/{{ i[11][1] }}.webp" alt="Team Logo" class="team-logo2">
                        {{ fn[i[11][1]] }}
                    </div>
                </div>

            </div>
    {% endif %}
  </div>
</div></a>
{% endif %}
{% endfor %}
</center>
<div class="extra-padding"></div>
<nav class="bottom-nav">
    <div class="bottom-nav-item active">
        <a href="{{ url_for('main.displayFR') }}">
      <span class="material-icons-round">event</span>
      <span class="bottom-nav-label">MATCHES</span>
      </a>
    </div>
    <div class="bottom-nav-item">
        <a href="{{ url_for('main.displayPT') }}">
      <span class="material-icons-round">table_chart</span>
      <span class="bottom-nav-label">PTS TABLE</span>
      </a>
    </div>
    <div class="bottom-nav-item spacer"></div>
    <div class="bottom-nav-item live">
        <a href="{{ url_for('main.todayMatch') }}">
      <div class="live-circle"></div>
      <div class="live-content">
        <span class="material-icons-round zoomInOut">play_arrow</span>
        <span class="bottom-nav-label">LIVE</span>
      </div>
      </a>
    </div>
    <div class="bottom-nav-item spacer"></div>
    <div class="bottom-nav-item">
      <a href="{{ url_for('main.teams') }}">
      <span class="material-icons-round">groups</span>
      <span class="bottom-nav-label">TEAMS</span>
      </a>
    </div>
    <div class="bottom-nav-item">
      <a href="{{ url_for('main.battingstats') }}">
      <span class="material-icons-round">bar_chart</span>
      <span class="bottom-nav-label">STATS</span>
      </a>
    </div>
  </nav>

<script>
      // Function to create a timer for a given clock element
      function createTimer(clockElement) {
      const deadline = new Date(clockElement.getAttribute("data-deadline")).getTime();

      const daysSpan = clockElement.querySelector(".days");
      const hoursSpan = clockElement.querySelector(".hours");
      const minutesSpan = clockElement.querySelector(".minutes");
      const secondsSpan = clockElement.querySelector(".seconds");

      const interval = setInterval(function () {
        const Tnow = new Date();
        const timeZone = 'Asia/Kolkata';
        const dateInTimeZone = new Date(Tnow.toLocaleString('en-US', { timeZone }));
        const now = dateInTimeZone.getTime();
        const t = deadline - now;

        if (t < 0) {
          clearInterval(interval);
          daysSpan.textContent = "0";
          hoursSpan.textContent = "0";
          minutesSpan.textContent = "0";
          secondsSpan.textContent = "0";
          return;
        }

        const days = Math.floor(t / (1000 * 60 * 60 * 24));
        const hours = Math.floor((t % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((t % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((t % (1000 * 60)) / 1000);

        daysSpan.textContent = days;
        hoursSpan.textContent = hours;
        minutesSpan.textContent = minutes;
        secondsSpan.textContent = seconds;
      }, 1000);
    }

    // Initialize timers for all clock elements
    document.querySelectorAll(".clockdiv").forEach(createTimer);

    </script>
    <script>
    function updateTeamNames() {
      const screenWidth = window.innerWidth;
      const teamElements = document.querySelectorAll('.team-name, .result1, .team-display');

      teamElements.forEach(element => {
        const fullName = element.getAttribute('full');
        const shortName = element.getAttribute('short');

        if (screenWidth <= 845) { // Mobile view breakpoint
          element.textContent = shortName;
        } else {
          element.textContent = fullName;
        }
      });
    }

    // Update team names on load and window resize
    window.addEventListener('resize', updateTeamNames);
    window.addEventListener('load', updateTeamNames);
  </script>
        <script>
	window.onload = function() {
  // Get the current date and time
  const currentDate = new Date();

  // Find all match elements
  const matches = document.querySelectorAll('.main-container');
  let targetMatch = null;

  matches.forEach(function(match) {
    // Get the match deadline (data-deadline attribute)
    const matchDate = new Date(match.querySelector('.header').getAttribute('data-deadline'));

    // Get the result element that contains the match status (e.g., "In Progress" or "Starts Sat, 22 Mar . 07:30 PM IST")
    const resultElement = match.querySelector('.result');

    // Determine if the match is ongoing (if the result is "In Progress")
    const isOngoing = resultElement && resultElement.textContent.trim() === 'Match is In-Progress';

    // Check if the match is upcoming (has a future date)
    const isUpcoming = matchDate > currentDate;

    if (isUpcoming) {
      // If the match is upcoming and no target match has been set yet, or if this is the closest upcoming match
      if (!targetMatch || matchDate < new Date(targetMatch.querySelector('.header').getAttribute('data-deadline'))) {
        targetMatch = match; // This will be the closest upcoming match
      }
    } else if (isOngoing) {
      // If the match is ongoing and no target match has been set yet
      targetMatch = match; // This will be the ongoing match
    }
  });

  // If no upcoming or ongoing match was found, look for the last completed match
  if (!targetMatch) {
    const completedMatches = Array.from(matches).filter(function(match) {
      const resultElement = match.querySelector('.result');
      return resultElement && resultElement.textContent.trim() !== 'Match is In-Progress';
    });

    // If there are completed matches, select the most recent one
    if (completedMatches.length > 0) {
      targetMatch = completedMatches[completedMatches.length - 1]; // Last completed match
    }
  }

  // Scroll to the selected target match if found
  if (targetMatch) {
    targetMatch.scrollIntoView({ behavior: 'smooth' });
    const offset = 91; // Padding value
      const targetPosition = targetMatch.getBoundingClientRect().top + window.pageYOffset;
      window.scrollTo({ top: targetPosition - offset, behavior: 'smooth' });
  }
};
// Add Move to Top button logic
(function() {
    // Create the button
    const moveTopBtn = document.createElement('button');
    moveTopBtn.id = 'moveTopBtn';
    moveTopBtn.className = 'floating-move-top-btn';
    moveTopBtn.title = 'Move to Top';
    moveTopBtn.style.display = 'none';
    moveTopBtn.innerHTML = '<i class="fa fa-arrow-up"></i>';
    document.body.appendChild(moveTopBtn);

    // Show/hide button on scroll
    window.addEventListener('scroll', function() {
        if (window.scrollY > 400) {
            moveTopBtn.style.display = 'flex';
        } else {
            moveTopBtn.style.display = 'none';
        }
    });

    // Scroll to top on click
    moveTopBtn.addEventListener('click', function() {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    });
})();
</script>
{% endblock %}
